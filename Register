import discord
from discord.ext import commands

@bot.command(name='등록')
async def Register(ctx):
    username = str(ctx.message.author)
    
    sheet3, rows = await get_sheet3()

    row = 2
    while (await sheet3.cell(row, 1)).value:
        row += 1

    await sheet3.update_cell(row, 1, username)

    role = discord.utils.get(ctx.guild.roles, id=1093781563508015105)
    await ctx.author.add_roles(role)

    embed = discord.Embed(description=f"{ctx.author.mention}님, 랜덤미션스터디에 정상적으로 등록됐습니다!",
                          color=0x00FF00)
    await ctx.send(embed=embed)
    
class RandomMissionView(View):
    def __init__(self, ctx: Context, message: discord.Message):
        super().__init__(timeout=None)
        self.ctx = ctx
        self.message = message

    @discord.ui.button(label='다시 뽑기')
    async def random_mission_button(self, button: Button, interaction: discord.Interaction):
        await self.message.delete()
        await self.ctx.invoke(self.ctx.bot.get_command('再次'))
